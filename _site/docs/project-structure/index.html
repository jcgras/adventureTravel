<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Project structure - Adventure Travel</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Project structure | Adventure Travel</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="Project structure" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/docs/project-structure/" /> <meta property="og:url" content="http://localhost:4000/docs/project-structure/" /> <meta property="og:site_name" content="Adventure Travel" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Project structure" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","headline":"Project structure","url":"http://localhost:4000/docs/project-structure/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> Adventure Travel </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="http://localhost:4000/docs/getting-started/" class="nav-list-link">Getting started</a></li><li class="nav-list-item"><a href="http://localhost:4000/docs/backend-config/" class="nav-list-link">Backend configuration</a></li><li class="nav-list-item"><a href="http://localhost:4000/docs/app-config/" class="nav-list-link">App configuration</a></li><li class="nav-list-item active"><a href="http://localhost:4000/docs/project-structure/" class="nav-list-link active">Project structure</a></li><li class="nav-list-item"><a href="http://localhost:4000/docs/push-notifications/" class="nav-list-link">Push Notifications</a></li><li class="nav-list-item"><a href="http://localhost:4000/docs/firebase-database-rules/" class="nav-list-link">Firebase Database Rules</a></li><li class="nav-list-item"><a href="http://localhost:4000/docs/migrating-to-your-brand/" class="nav-list-link">Extra: Migrating to your own brand</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Adventure Travel" aria-label="Search Adventure Travel" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="project-structure"> <a href="#project-structure" class="anchor-heading" aria-labelledby="project-structure"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Project Structure </h1> <p>In this session we will describe the structure designed for this project. With this design we intend to offer you a solution adaptable to any kind of management app. With the combination of Redux and Firebase Realtime Database technologies we can generate a synchronized system, which allows the update in real time with all your devices.</p><hr /> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#application-modules" id="markdown-toc-application-modules">Application modules</a> <ol> <li><a href="#static-images" id="markdown-toc-static-images">Static images</a></li> </ol> </li> <li><a href="#redux-one-state-to-rule-them-all" id="markdown-toc-redux-one-state-to-rule-them-all">Redux, one state to rule them all</a> <ol> <li><a href="#reducers" id="markdown-toc-reducers">Reducers</a></li> <li><a href="#dispatching-actions" id="markdown-toc-dispatching-actions">Dispatching actions</a></li> <li><a href="#middlewares" id="markdown-toc-middlewares">Middlewares</a></li> <li><a href="#store" id="markdown-toc-store">Store</a></li> </ol> </li> <li><a href="#components" id="markdown-toc-components">Components</a> <ol> <li><a href="#hooks-approach" id="markdown-toc-hooks-approach">Hooks approach</a> <ol> <li><a href="#connecting-to-the-store" id="markdown-toc-connecting-to-the-store">Connecting to the store</a></li> <li><a href="#search-component" id="markdown-toc-search-component">Search component</a></li> </ol> </li> </ol> </li> </ol><hr /> <h2 id="application-modules"> <a href="#application-modules" class="anchor-heading" aria-labelledby="application-modules"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Application modules </h2> <blockquote class="text-grey-dk-000"> <p>A structure must be simple enough for new team members to quickly get on board and immerse themselves into the project.</p> </blockquote> <p>React‚Äôs ecosystem offers users complete control over everything, without being tied to any particular way of doing things. However, whenever we work on a React project it is necessary to use some kind of consensus to organize the source code. With this in mind, we believe that the ideal React project structure is the one that allows you to move around your code with the least amount of effort. Following this principle, <strong>Adventure Travel</strong> is made up of a simple project structure that allows you to easily scalate, adapt, reuse and create React Native components. In any case, you are welcome to adjust this structure for your own use case.</p> <p>To get into context, let‚Äôs start analyzing the project from the JavaScript source code located in the <strong>/src</strong> folder. Remember that React Native uses the JavaScript language to generate from the source code to iOS and Android platforms, both in the <strong>/ios</strong> and <strong>android</strong> folders respectively. Inside the <strong>/src</strong> folder all the modules of the application will be organized.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>üìÇ src
 ‚î£ üìÅ common
 ‚î£ üìÅ components
 ‚î£ üìÅ images
 ‚î£ üìÅ navigation
 ‚î£ üìÅ redux
 ‚î£ üìÅ screens
 ‚îó üì¶ package.json
</code></pre></div></div> <div class="table-wrapper"><table> <thead> <tr> <th>Module</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><em>common</em></td> <td>It contains the common elements such as global styles, colors, utils, database access, etc.</td> </tr> <tr> <td><em>components</em></td> <td>Here we place the application components and their related styles.</td> </tr> <tr> <td><em>images</em></td> <td>It contains the static images used in the project such as illustrations, logos, etc.</td> </tr> <tr> <td><em>navigation</em></td> <td>This module contains the components related to navigation. It contains the paths and references to screens, modals and tabs.</td> </tr> <tr> <td><em>redux</em></td> <td>It contains the elements related to Redux: reducers, middlewares and the store configuration.</td> </tr> <tr> <td><em>screens</em></td> <td>It contains the components relating to the application screens and their related styles.</td> </tr> </tbody> </table></div> <p>You have probably noticed that in each of these modules the files <code class="language-plaintext highlighter-rouge">index.js</code> and <code class="language-plaintext highlighter-rouge">package.json</code> are included. Both files are used to export and define the module with global access within the project.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>üìÇ src
 ‚î£ üìÇ common
 ‚îÉ ‚î£ Color.js
 ‚îÉ ‚î£ Device.js
 ‚îÉ ‚î£ Firestore.js
 ‚îÉ ‚î£ GoogleAPIs.js
 ‚îÉ ‚î£ Images.js
 ‚îÉ ‚î£ index.js
 ‚îÉ ‚î£ RealtimeDatabase.js
 ‚îÉ ‚î£ Styles.js
 ‚îÉ ‚î£ Util.js
 ‚îÉ ‚îó üì¶ package.json
 ‚î£ üìÅ components
 ‚î£ üìÅ images
 ‚î£ üìÅ redux
 ‚î£ üìÅ screens
 ‚îó üì¶ package.json
</code></pre></div></div> <p>In the <code class="language-plaintext highlighter-rouge">index.js</code> file we must include all the module reference (imports) and then export it to make it visible outside the folder.</p> <p><em>/src/common/index.js</em></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">Styles</span><span class="p">,</span> <span class="nx">FontSize</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./Styles</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Color</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./Color</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Device</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./Device</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Images</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./Images</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">RealtimeDatabase</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./RealtimeDatabase</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Firestore</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./Firestore</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Util</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./Util</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">GoogleAPIs</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./GoogleAPIs</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="p">{</span>
  <span class="nx">Styles</span><span class="p">,</span>
  <span class="nx">Color</span><span class="p">,</span>
  <span class="nx">FontSize</span><span class="p">,</span>
  <span class="nx">Device</span><span class="p">,</span>
  <span class="nx">Images</span><span class="p">,</span>
  <span class="nx">RealtimeDatabase</span><span class="p">,</span>
  <span class="nx">Firestore</span><span class="p">,</span>
  <span class="nx">Util</span><span class="p">,</span>
  <span class="nx">GoogleAPIs</span><span class="p">,</span>
<span class="p">};</span>
</code></pre></div></div> <p>Also using the <code class="language-plaintext highlighter-rouge">package.json</code> file we can define the name of the package as global and use it anywhere in the project.</p> <p><em>/src/common/package.json</em></p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@common"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>Now if you need to import something (like <code class="language-plaintext highlighter-rouge">Color</code>) from the <code class="language-plaintext highlighter-rouge">common</code> module you can refered it using <code class="language-plaintext highlighter-rouge">@common</code> route instead of all the static route.</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Color</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@common</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">primaryColor</span> <span class="o">=</span> <span class="nx">Color</span><span class="p">.</span><span class="nx">primary</span><span class="p">;</span>
</code></pre></div></div> <h3 id="static-images"> <a href="#static-images" class="anchor-heading" aria-labelledby="static-images"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Static images </h3> <p>In any mobile application project it is necessary to use static image files (embedded in the app) instead of always downloading them from the Internet. This applies mainly for image files such as illustrations, logos, icons, etc. For this reason we have included a single folder to store all the embedded image files, located in the path: <strong>/src/images</strong>. We have included also the <code class="language-plaintext highlighter-rouge">Images.js</code> file in the <code class="language-plaintext highlighter-rouge">@common</code> module to export the reference of all the static images, located in the images folder.</p> <p><em>/src/common/Images.js</em></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
    <span class="na">logoWhite</span><span class="p">:</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">@images/logos/logoWhite.png</span><span class="dl">"</span><span class="p">),</span>
    <span class="na">IllustSettings</span><span class="p">:</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">@images/illustrations/settings.png</span><span class="dl">"</span><span class="p">),</span>
<span class="p">}</span>
</code></pre></div></div> <p>Whenever you need to use a static image just reference <code class="language-plaintext highlighter-rouge">Images</code> from the <code class="language-plaintext highlighter-rouge">@common</code> module.</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Images</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@common</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">//....</span>
<span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">View</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Image</span> <span class="nx">source</span><span class="o">=</span><span class="p">{</span><span class="nx">Images</span><span class="p">.</span><span class="nx">logoWhite</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/View</span><span class="err">&gt;
</span><span class="p">);</span>
</code></pre></div></div><hr /> <h2 id="redux-one-state-to-rule-them-all"> <a href="#redux-one-state-to-rule-them-all" class="anchor-heading" aria-labelledby="redux-one-state-to-rule-them-all"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Redux, one state to rule them all </h2> <blockquote class="text-grey-dk-000"> <p>Redux handles the entire application data flow within a single container while the previous state persists as well.</p> </blockquote> <p>As an important part of the architecture, we have included <strong>Redux</strong> for application status management. With Redux we can have one application state as a global state (‚ÄúSingle source of truth‚Äù), that includes all application data -like bookings and bookmarks- but also temporary states like search results, search history or popular destinations. The whole state of the app is stored in an object tree inside a single store. The only way to change the state tree is to emit an action, an object describing what happened. (<a href="https://redux.js.org/introduction/getting-started" target="_blank">Redux Documentation<img src="/images/ext-link.png" alt="icon" /></a>)</p> <p class="my-5 fs-3"><img src="/images/redux_states.png" alt="Image" /><br /> <em>Tree view from <a href="https://github.com/jhen0409/react-native-debugger" target="_blank">React Native Debugger<img src="/images/ext-link.png" alt="icon" /></a></em></p> <p>To use this library (actually Redux is a library) a <strong>redux</strong> module was created that includes the <strong>middlewares</strong>, <strong>reducers</strong> folders and the <code class="language-plaintext highlighter-rouge">store.js</code> file. Following the same logic as above, we have also included the <code class="language-plaintext highlighter-rouge">package.json</code> file for the module name.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>üìÇ src
 ‚î£ üìÅ common
 ‚î£ üìÅ components
 ‚î£ üìÅ images
 ‚î£ üìÇ redux
 ‚îÉ ‚î£ üìÅ middlewares
 ‚îÉ ‚î£ üìÅ reducers
 ‚îÉ ‚î£ üì¶ package.json
 ‚îÉ ‚îó store.js
 ‚î£ üìÅ screens
 ‚îó üì¶ package.json
</code></pre></div></div> <h3 id="reducers"> <a href="#reducers" class="anchor-heading" aria-labelledby="reducers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reducers </h3> <p>Reducers are the pure functions that take the current state and action and return the new state and tell the store how to do. To summarize, the reducers specify how the actions transform the state tree. We have included the <strong>reducers</strong> folder to group the reducers of each object.</p> <p><em>/src/redux/reducers/bookmarks.js</em></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">defaultState</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">ADD_BOOKMARK</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">ADD_BOOKMARK</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">DELETE_BOOKMARK</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">DELETE_BOOKMARK</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">CLEAR_BOOKMARKS</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">CLEAR_BOOKMARKS</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">reducer</span><span class="p">(</span><span class="nx">state</span> <span class="o">=</span> <span class="nx">defaultState</span><span class="p">,</span> <span class="p">{</span><span class="nx">type</span><span class="p">,</span> <span class="nx">payload</span><span class="p">})</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="dl">'</span><span class="s1">ADD_BOOKMARK</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">[...</span><span class="nx">state</span><span class="p">,</span> <span class="nx">payload</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">case</span> <span class="dl">'</span><span class="s1">DELETE_BOOKMARK</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">state</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">id</span> <span class="o">!==</span> <span class="nx">payload</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">case</span> <span class="dl">'</span><span class="s1">CLEAR_BOOKMARKS</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">defaultState</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nl">default</span><span class="p">:</span>
      <span class="k">return</span> <span class="nx">state</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">reducer</span><span class="p">;</span>
</code></pre></div></div> <h3 id="dispatching-actions"> <a href="#dispatching-actions" class="anchor-heading" aria-labelledby="dispatching-actions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Dispatching actions </h3> <p>The only way to change the single source of data (state tree) is to emit an action. For this purpose we can use the React hook to trigger actions: <code class="language-plaintext highlighter-rouge">useDispatch</code> and the previous created reducers.</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">ADD_BOOKMARK</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@redux/reducers/bookmarks</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">useDispatch</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-redux</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">dispatch</span> <span class="o">=</span> <span class="nx">useDispatch</span><span class="p">();</span>

<span class="kd">const</span> <span class="nx">experience</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Private Wine Country Tour</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">place</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Sonoma, US</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">destination</span><span class="p">:</span> <span class="dl">"</span><span class="s2">San Francisco</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">duration</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1.5 hours</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">...</span>
<span class="p">}</span>

<span class="nx">dispatch</span><span class="p">({</span><span class="na">type</span><span class="p">:</span> <span class="nx">ADD_BOOKMARK</span><span class="p">,</span> <span class="na">payload</span><span class="p">:</span> <span class="nx">experience</span><span class="p">});</span>

</code></pre></div></div> <h3 id="middlewares"> <a href="#middlewares" class="anchor-heading" aria-labelledby="middlewares"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Middlewares </h3> <p>Basically a middleware is some code you can put between the framework receiving a request, and the framework generating a response. Redux middleware provides a third-party extension point between dispatching an action, and the moment it reaches the reducer. You can usually use Redux middleware for logging, crash reporting, talking to an asynchronous API, routing, and more. - <a href="https://redux.js.org/advanced/middleware" target="_blank">Redux Middleware<img src="/images/ext-link.png" alt="icon" /></a></p> <p>In this architecture we have included a <strong>middleware</strong> to manage the synchronization between remote data (Firebase Realtime Database) and local data (local store). For instance, when we dispatch the action <strong>ADD_BOOKMARK</strong> this middleware will be invoked, the action will be detected and the information will be sent to the remote database. At the same time the action is executed and the local store is updated from the corresponding <strong>reducer</strong>.</p> <p><em>/src/redux/middlewares/firebase.js</em></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">database</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@react-native-firebase/database</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">auth</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@react-native-firebase/auth</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">firebase</span> <span class="o">=</span> <span class="p">(</span><span class="nx">store</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">action</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">switch</span> <span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="dl">'</span><span class="s1">ADD_BOOKMARK</span><span class="dl">'</span><span class="p">:</span>
      <span class="nx">next</span><span class="p">(</span><span class="nx">action</span><span class="p">);</span>
      <span class="nx">database</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">ref</span><span class="p">(</span><span class="s2">`/bookmarks/</span><span class="p">${</span><span class="nx">auth</span><span class="p">().</span><span class="nx">currentUser</span><span class="p">.</span><span class="nx">uid</span><span class="p">}</span><span class="s2">/</span><span class="p">${</span><span class="nx">action</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
        <span class="p">.</span><span class="kd">set</span><span class="p">({...</span><span class="nx">action</span><span class="p">.</span><span class="nx">payload</span><span class="p">,</span> <span class="na">created</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">()});</span>
      <span class="k">break</span><span class="p">;</span>
      <span class="c1">//........</span>
   <span class="p">}</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">firebase</span><span class="p">;</span>
</code></pre></div></div> <p>The above example applies to updating remote data, however when using Firebase Realtime Database, synchronization can occur in reverse. That is, if you update the remote data, either from another device or from another interface such as a website, you must also update the local store. To complete this cycle a <strong>startListening</strong> function has been added to ‚Äúlisten‚Äù all the time for remote Firebase updates and update the local store only if the information does not exist.</p> <p><em>/src/common/RealtimeDatabase.js</em></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">database</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@react-native-firebase/database</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">store</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@redux/store</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">RealtimeDatabase</span> <span class="o">=</span> <span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">startListening</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="p">{</span><span class="nx">user</span><span class="p">}</span> <span class="o">=</span> <span class="nx">store</span><span class="p">.</span><span class="nx">getState</span><span class="p">();</span>
      <span class="cm">/* Listening for new bookmark */</span>
      <span class="nx">database</span><span class="p">()</span>
        <span class="p">.</span><span class="nx">ref</span><span class="p">(</span><span class="s2">`bookmarks/</span><span class="p">${</span><span class="nx">user</span><span class="p">.</span><span class="nx">uid</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">orderByChild</span><span class="p">(</span><span class="dl">'</span><span class="s1">created</span><span class="dl">'</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">child_added</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">snapshot</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">newBookmark</span> <span class="o">=</span> <span class="nx">snapshot</span><span class="p">.</span><span class="nx">val</span><span class="p">();</span>
          <span class="kd">const</span> <span class="p">{</span><span class="nx">bookmarks</span><span class="p">}</span> <span class="o">=</span> <span class="nx">store</span><span class="p">.</span><span class="nx">getState</span><span class="p">();</span>
          <span class="kd">const</span> <span class="nx">exist</span> <span class="o">=</span> <span class="nx">bookmarks</span><span class="p">.</span><span class="nx">some</span><span class="p">((</span><span class="nx">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">newBookmark</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
          <span class="c1">// Add only if you are on another device (the bookmark doesn't exist)</span>
          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">exist</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">({</span>
              <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">ADD_BOOKMARK</span><span class="dl">'</span><span class="p">,</span>
              <span class="na">payload</span><span class="p">:</span> <span class="nx">newBookmark</span><span class="p">,</span>
            <span class="p">});</span>
          <span class="p">}</span>
        <span class="p">});</span>
    <span class="c1">//........</span>
<span class="p">})();</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">RealtimeDatabase</span><span class="p">;</span>
</code></pre></div></div> <h3 id="store"> <a href="#store" class="anchor-heading" aria-labelledby="store"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Store </h3> <p>The store is the object which holds the state of the application. We have created the <code class="language-plaintext highlighter-rouge">store.js</code> file to include the single store for the entire application, as recommended by the Redux documentation:</p> <blockquote class="text-grey-dk-000"> <p>It‚Äôs important to note that you‚Äôll only have a single store in a Redux application. When you want to split your data handling logic, you‚Äôll use reducer composition instead of many stores. - <a href="https://redux.js.org/basics/store" target="_blank">Redux Documentation<img src="/images/ext-link.png" alt="icon" /></a></p> </blockquote> <p>To start using the store instance you just need to import and call <code class="language-plaintext highlighter-rouge">createStore</code>. In our case we use multiple reducers, therefore it is necessary to include the <code class="language-plaintext highlighter-rouge">combineReducers()</code> function to combine several reducers into one.</p> <p><em>/src/redux/store.js</em></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">createStore</span><span class="p">,</span> <span class="nx">combineReducers</span><span class="p">,</span> <span class="nx">compose</span><span class="p">,</span> <span class="nx">applyMiddleware</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">redux</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">persistStore</span><span class="p">,</span> <span class="nx">persistReducer</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">redux-persist</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">thunk</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">redux-thunk</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">firebase</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./middlewares/firebase</span><span class="dl">'</span><span class="p">;</span>
<span class="c1">// ...</span>
<span class="k">import</span> <span class="nx">searchHistory</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./reducers/searchHistory</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">bookmarks</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./reducers/bookmarks</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">bookings</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./reducers/bookings</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">config</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./reducers/config</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">reducer</span> <span class="o">=</span> <span class="nx">combineReducers</span><span class="p">({</span>
    <span class="c1">// ...</span>
    <span class="nx">searchHistory</span><span class="p">,</span>
    <span class="nx">bookmarks</span><span class="p">,</span>
    <span class="nx">bookings</span><span class="p">,</span>
    <span class="nx">config</span><span class="p">,</span>
<span class="p">});</span>
</code></pre></div></div> <p>We also use <code class="language-plaintext highlighter-rouge">Redux-Persist</code> to save the Redux store when the app is closed, and refer to the middlewares: <code class="language-plaintext highlighter-rouge">firebase</code> middleware (described above) and <code class="language-plaintext highlighter-rouge">Redux-Thunk</code> middleware to write Action Creators that return a function instead of an action. This last element is the one that allows us to create actions such as <code class="language-plaintext highlighter-rouge">addBookmark</code> as functions.</p> <p><em>/src/redux/store.js</em></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">persistConfig</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">key</span><span class="p">:</span> <span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">storage</span><span class="p">:</span> <span class="nx">AsyncStorage</span><span class="p">,</span>
  <span class="na">whitelist</span><span class="p">:</span> <span class="p">[</span>
    <span class="dl">'</span><span class="s1">user</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">explore</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">categories</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">popular</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">searchHistory</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">bookmarks</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">bookings</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">config</span><span class="dl">'</span><span class="p">,</span>
  <span class="p">],</span>
  <span class="na">blacklist</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">composeEnhancers</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">__REDUX_DEVTOOLS_EXTENSION_COMPOSE__</span> <span class="o">||</span> <span class="nx">compose</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">persistedReducer</span> <span class="o">=</span> <span class="nx">persistReducer</span><span class="p">(</span><span class="nx">persistConfig</span><span class="p">,</span> <span class="nx">reducer</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">createStore</span><span class="p">(</span>
  <span class="nx">persistedReducer</span><span class="p">,</span>
  <span class="nx">composeEnhancers</span><span class="p">(</span><span class="nx">applyMiddleware</span><span class="p">(</span><span class="nx">thunk</span><span class="p">,</span> <span class="nx">firebase</span><span class="p">)),</span>
<span class="p">);</span>
<span class="kd">let</span> <span class="nx">persistor</span> <span class="o">=</span> <span class="nx">persistStore</span><span class="p">(</span><span class="nx">store</span><span class="p">);</span>

<span class="k">export</span> <span class="p">{</span><span class="nx">persistor</span><span class="p">,</span> <span class="nx">store</span><span class="p">};</span>
</code></pre></div></div> <p>Below, we specify how the store is connected to the user interface.</p><hr /> <h1 id="components"> <a href="#components" class="anchor-heading" aria-labelledby="components"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Components </h1> <p>As you probably know, React bases its architecture on components. That is: each piece of an app is handled as an isolated component (class or Hook) where its own states, properties, styles and the access to the store are handled. With <strong>Adventure Travel</strong> you have a variety ready-to-use components to create your own mobile application using <u>Hooks</u> approache. Components like <code class="language-plaintext highlighter-rouge">ButtonGradient</code>, <code class="language-plaintext highlighter-rouge">CardPopular</code> or <code class="language-plaintext highlighter-rouge">ImageCollage</code> can be found in the <strong>/src/components</strong> folder. Similarly we have created a folder to organize the components relating to the screens of the app: <strong>/src/screens</strong>. In this way we separate more atomic components like <code class="language-plaintext highlighter-rouge">ButtonGradient</code> from the more complex ones that compose a screen.</p> <h2 id="hooks-approach"> <a href="#hooks-approach" class="anchor-heading" aria-labelledby="hooks-approach"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hooks approach </h2> <p><u>Hooks</u> uses a function as a component with all properties included in a single object in the function parameter.</p> <p><em>/src/components/ButtonBookmark/index.js</em></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span><span class="nx">useEffect</span><span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">ButtonBookmark</span> <span class="o">=</span> <span class="p">({</span><span class="nx">experienceId</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">confirm</span> <span class="o">=</span> <span class="kc">false</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">},</span> <span class="p">[]);</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="c1">// ...</span>
    <span class="p">);</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
    <span class="na">content</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">alignSelf</span><span class="p">:</span> <span class="dl">"</span><span class="s2">flex-end</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">alignItems</span><span class="p">:</span> <span class="dl">"</span><span class="s2">flex-end</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">padding</span><span class="p">:</span> <span class="mi">8</span>
    <span class="p">},</span>
    <span class="na">icon</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">fontSize</span><span class="p">:</span> <span class="mi">20</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div> <p>Likewise, each component includes the reference to the component‚Äôs own styles using <code class="language-plaintext highlighter-rouge">StyleSheet</code> within the same file. Using the constant <code class="language-plaintext highlighter-rouge">styles</code> you can access the styles inside each component.</p> <h3 id="connecting-to-the-store"> <a href="#connecting-to-the-store" class="anchor-heading" aria-labelledby="connecting-to-the-store"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Connecting to the store </h3> <p>To connect the Redux store to the UI (components) we use the <code class="language-plaintext highlighter-rouge">useSelector</code> and <code class="language-plaintext highlighter-rouge">useDispatch</code> hooks from <strong>react-redux</strong>. The <code class="language-plaintext highlighter-rouge">useSelector</code> function provides to the component the data it requires from the store, and the <code class="language-plaintext highlighter-rouge">useDispatch</code> function it‚Äôs used to send (dispatch) actions to the store. If the component requires the use of an action that handles the state of the application, such as <code class="language-plaintext highlighter-rouge">ADD_BOOKMARK</code>, you can import it from the <strong>reducers</strong> folder.</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">ADD_BOOKMARK</span><span class="p">,</span> <span class="nx">DELETE_BOOKMARK</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@redux/reducers/bookmarks</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">useSelector</span><span class="p">,</span> <span class="nx">useDispatch</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-redux</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div> <p>Then you can create a variable to access to any state of the application through the <code class="language-plaintext highlighter-rouge">useSelector</code> function. Also you can create a dispatch variable from the <code class="language-plaintext highlighter-rouge">useDispatch</code> hook to send an action to the store such as <code class="language-plaintext highlighter-rouge">ADD_BOOKMARK</code> or <code class="language-plaintext highlighter-rouge">DELETE_BOOKMARK</code>.</p> <p><em>/src/components/ButtonBookmark/index.js</em></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">ADD_BOOKMARK</span><span class="p">,</span> <span class="nx">DELETE_BOOKMARK</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@redux/reducers/bookmarks</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span><span class="nx">useSelector</span><span class="p">,</span> <span class="nx">useDispatch</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-redux</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">ButtonBookmark</span> <span class="o">=</span> <span class="p">({</span><span class="nx">experienceId</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">confirm</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">bookmarks</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">((</span><span class="nx">state</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">bookmarks</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">booked</span> <span class="o">=</span> <span class="nx">bookmarks</span><span class="p">.</span><span class="nx">some</span><span class="p">((</span><span class="nx">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">experienceId</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">experiences</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">((</span><span class="nx">state</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">explore</span><span class="p">.</span><span class="nx">experienceResults</span><span class="p">.</span><span class="nx">experiences</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">dispatch</span> <span class="o">=</span> <span class="nx">useDispatch</span><span class="p">();</span>

  <span class="kd">const</span> <span class="nx">handleAddBookmark</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">experience</span> <span class="o">=</span> <span class="nx">experiences</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">e</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">experienceId</span><span class="p">);</span>
    <span class="nx">dispatch</span><span class="p">({</span><span class="na">type</span><span class="p">:</span> <span class="nx">ADD_BOOKMARK</span><span class="p">,</span> <span class="na">payload</span><span class="p">:</span> <span class="nx">experience</span><span class="p">});</span>
  <span class="p">};</span>

  <span class="kd">const</span> <span class="nx">handleRemoveBookmark</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">confirm</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">confirmRemoveBookmark</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">dispatch</span><span class="p">({</span><span class="na">type</span><span class="p">:</span> <span class="nx">DELETE_BOOKMARK</span><span class="p">,</span> <span class="na">payload</span><span class="p">:</span> <span class="nx">experienceId</span><span class="p">});</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="p">(</span>
      <span class="c1">// ...</span>
  <span class="p">);</span>
</code></pre></div></div> <h3 id="search-component"> <a href="#search-component" class="anchor-heading" aria-labelledby="search-component"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Search component </h3> <p>From version 1.0.5 you can make dynamic searches of Experiences, we incorporated geolocation-based search methods for dynamic search results. We have added a simple algorithm to search for locations based on geohash coordinates, which you may find useful in your project.</p> <p><strong>What is Geohashing anyway?</strong></p> <p>Geohashing is a geocoding method used to encode geographic coordinates (latitude and longitude) into a short string of digits and letters delineating an area on a map, which is called a cell, with varying resolutions. The more characters in the string, the more precise the location. <em><a href="https://www.pubnub.com/learn/glossary/what-is-geohashing/" target="_blank">PubNub<img src="/images/ext-link.png" alt="icon" /></a></em></p> <p>In this case a <strong>location</strong> (latitude and longitude) and a <strong>geohash</strong> (the coding of <strong>location</strong>) has been added to each experience, stored in the <em>experiences</em> collection.</p> <p><img src="/images/firestore_geohash.png" alt="Image" /></p> <p>To codify a geohash from coordinates you can use an online tool like <a href="https://www.movable-type.co.uk/scripts/geohash.html" target="_blank">Geohashes Movable Type Scripts<img src="/images/ext-link.png" alt="icon" /></a> or for React Native, use the <strong>ngeohash</strong> library:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">geohash</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">ngeohash</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">lat</span> <span class="o">=</span> <span class="mf">38.7437396</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">lon</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.230243</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">geohash</span> <span class="o">=</span> <span class="nx">geohash</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="nx">lat</span><span class="p">,</span> <span class="nx">lon</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">geohash</span><span class="p">);</span> <span class="c1">// output: eyckmv</span>
</code></pre></div></div> <p>With a range of geohash codes (<em>lower</em> and <em>upper</em>) it is possible to do a search by a single <em>string</em> index (<code class="language-plaintext highlighter-rouge">geohash</code>) in the database, where the closest geohashes in string indicate the proximity in distance:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Search of experiences in database according to a range of geohahes</span>
<span class="kd">const</span> <span class="nx">querySnapshot</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">firestore</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">collection</span><span class="p">(</span><span class="dl">'</span><span class="s1">experiences</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="dl">'</span><span class="s1">geohash</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">&gt;=</span><span class="dl">'</span><span class="p">,</span> <span class="nx">geoRange</span><span class="p">.</span><span class="nx">lower</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="dl">'</span><span class="s1">geohash</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">&lt;=</span><span class="dl">'</span><span class="p">,</span> <span class="nx">geoRange</span><span class="p">.</span><span class="nx">upper</span><span class="p">)</span>
    <span class="p">.</span><span class="kd">get</span><span class="p">();</span>
</code></pre></div></div> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2022 Svalbard. Distributed by an <a href="https://github.com/just-the-docs/just-the-docs/blob/main/LICENSE.txt">MIT license.</a></p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
