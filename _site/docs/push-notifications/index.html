<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Push Notifications - Adventure Travel</title> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs.css"> <script type="text/javascript" src="http://localhost:4000/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Push Notifications | Adventure Travel</title> <meta name="generator" content="Jekyll v3.8.6" /> <meta property="og:title" content="Push Notifications" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/docs/push-notifications/" /> <meta property="og:url" content="http://localhost:4000/docs/push-notifications/" /> <meta property="og:site_name" content="Adventure Travel" /> <script type="application/ld+json"> {"headline":"Push Notifications","@type":"WebPage","url":"http://localhost:4000/docs/push-notifications/","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000" class="site-title lh-tight"> Adventure Travel </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item"><a href="http://localhost:4000/" class="navigation-list-link">Home</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/getting-started/" class="navigation-list-link">Getting started</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/backend-config/" class="navigation-list-link">Backend configuration</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/app-config/" class="navigation-list-link">App configuration</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/project-structure/" class="navigation-list-link">Project structure</a></li><li class="navigation-list-item active"><a href="http://localhost:4000/docs/push-notifications/" class="navigation-list-link active">Push Notifications</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/firebase-database-rules/" class="navigation-list-link">Firebase Database Rules</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/migrating-to-your-brand/" class="navigation-list-link">Extra: Migrating to your own brand</a></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Adventure Travel" aria-label="Search Adventure Travel" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> </div> <div class="page"> <div id="main-content" class="page-content" role="main"> <h1 class="no_toc" id="push-notifications"> <a href="#push-notifications" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Push Notifications </h1> <p>We have added <strong>push notifications</strong> to this project, allowing you to send alerts to users using <strong>Firebase Cloud Messaging (FCM)</strong> service. FCM is a cross-platform messaging solution that lets you reliably send messages at no cost. Notifications can be sent directly from Firebase Console or through third party applications integrated with FCM. If you want to set up push notifications for your project on iOS you need to make some security settings first. But for Android projects you are not required to do anything else and you can start testing by <a href="/docs/push-notifications/#broadcasting-push-notifications-from-fcm">broadcasting push notifications from FCM</a>.</p> <hr /> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#apple-push-notifications-service-apns-configuration" id="markdown-toc-apple-push-notifications-service-apns-configuration">Apple Push Notifications service (APNs) configuration</a> <ol> <li><a href="#generate-a-certificate-request" id="markdown-toc-generate-a-certificate-request">Generate a Certificate Request</a></li> <li><a href="#generate-a-certificate-from-apple-developer-program" id="markdown-toc-generate-a-certificate-from-apple-developer-program">Generate a certificate from Apple Developer Program</a></li> <li><a href="#generate-and-import-a-p8-key" id="markdown-toc-generate-and-import-a-p8-key">Generate and import a .p8 key</a></li> </ol> </li> <li><a href="#broadcasting-push-notifications-from-fcm" id="markdown-toc-broadcasting-push-notifications-from-fcm">Broadcasting Push Notifications from FCM</a></li> </ol> <hr /> <h2 id="apple-push-notifications-service-apns-configuration"> <a href="#apple-push-notifications-service-apns-configuration" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Apple Push Notifications service (APNs) configuration </h2> <blockquote class="text-grey-dk-000"> <p>As a first requirement you should keep in mind that push notifications for iOS is only possible on <strong>physical devices</strong> and does not apply to simulators. Therefore, if you want to test push notifications in iOS, you should connect a physical device to your computer and run the app from there. Also you must have a paid Apple Developer Program account to create certificates for push notifications.</p> </blockquote> <p>Security certificates are required to start push notifications on iOS-based devices. Below we will describe the steps required to obtain and configure development certificates, which although indicated as being for development, it is also possible to use it in production applications. However, it is recommended to use certificates issued by certified authorities for production applications.</p> <h3 id="generate-a-certificate-request"> <a href="#generate-a-certificate-request" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Generate a Certificate Request </h3> <p>We must start by generating a certificate request, for that we must open the <strong>Keychain Access</strong> program, accessible from <em>Finder-&gt;Applications-&gt;Utilities</em> in a MAC environment. From the main menu of Keychain Access, select the menu <em>Certificate Assistant-&gt;Request a Certificate From a Certificate Authority…</em></p> <p><img src="/images/KeychainAccessMenu.png" alt="Image" /></p> <p>In the assistant you must fill out an applicant’s email address, the name and email address of the authority, in this case as it is a development environment you can put any value. Then select <strong>save to disk</strong> and <strong>continue</strong> to generate a certificate request file that you should save for the next action.</p> <p><img src="/images/CertificateAssistant.png" alt="Image" /></p> <h3 id="generate-a-certificate-from-apple-developer-program"> <a href="#generate-a-certificate-from-apple-developer-program" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Generate a certificate from Apple Developer Program </h3> <p>With the certificate request file, generated previously, you can get a certificate for the push notifications. To do that, you must log in to the <a href="https://developer.apple.com" target="_blank">Apple Developer Program<img src="/images/ext-link.png" alt="icon" /></a> site using your apple developer account and go to the <strong>Account</strong> menu and then to <a href="https://developer.apple.com/account/resources/certificates/list" target="_blank"><strong>Certificates, IDs &amp; Profiles</strong><img src="/images/ext-link.png" alt="icon" /></a>. Select <strong>Identifiers</strong> from the menu on the left to add/edit your app identifier.</p> <p><img src="/images/identifiers.png" alt="Image" /></p> <p>If your app identifier is not created yet you can click on the <strong>plus</strong> icon to add your app identifier. In this case you must register an <strong>App ID</strong>, specify the <strong>Bundle ID</strong> and check the option for <strong>Push Notifications</strong>. If your App ID already exists select it and go to <strong>Push Notifications</strong> and check it. Then select the <strong>configure</strong> button.</p> <p><img src="/images/configureIdentifier.png" alt="Image" /></p> <p>Then click on the <strong>Create Certificate</strong> button under the <strong>Development SSL Certificate</strong> option.</p> <p><img src="/images/DevelopmentSSLCertificate.png" alt="Image" /></p> <p>From the new screen you must upload the <strong>Certificate Signing Request</strong> file, generated previously.</p> <p><img src="/images/uploadCertificateRequest.png" alt="Image" /></p> <p>Finally click on <strong>continue</strong> to generate the certificate and download it. Open the downloaded certificate by double-clicking it to import it into <strong>Keychain Access</strong> and have it installed in your environment.</p> <p>After the certificate is imported into Keychain Access, open the iOS project from Xcode and select the tab <strong>Signing &amp; Capabilities</strong> and then the option <strong>+ Capability</strong>. Add the capabilities <strong>Push Notifications</strong> and <strong>Background Modes</strong> and check the option <strong>Remote notifications</strong>.</p> <p><img src="/images/xcodeCapability.png" alt="Image" /></p> <h3 id="generate-and-import-a-p8-key"> <a href="#generate-and-import-a-p8-key" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Generate and import a .p8 key </h3> <p>To start sending push notifications from the <strong>FCM</strong> service it is necessary to first generate a .p8 key to sign the messages. To do this you must go back to <a href="https://developer.apple.com/account/resources/certificates/list" target="_blank"><strong>Certificates, IDs &amp; Profiles</strong><img src="/images/ext-link.png" alt="icon" /></a> from the <strong>Apple Developer Program</strong> site and select the <strong>Keys</strong> menu and click on the <strong>plus</strong> icon to add a new key. Specify a name for the new key, check the <strong>APNs</strong> option and click <strong>continue</strong>.</p> <p><img src="/images/newAPNsKey.png" alt="Image" /></p> <p>Download the key once it is generated. Note that you can only download once, so you must store it securely. Similarly copies the value of the <strong>Key ID</strong>, although you can always access this value from the <strong>Keys</strong> menu.</p> <p>This .p8 key must be added to <strong>Firebase Cloud Messaging</strong> in order to issue push notifications. To do this you must go to the <strong>Firebase Console</strong> and access to the <strong>Project Settings</strong> menu.</p> <p><img src="/images/FirebaseSettings.png" alt="Image" /></p> <p>Then access to the <strong>Cloud Messaging</strong> tab and go down to the <strong>iOS app configuration</strong> option to upload the .p8 file.</p> <p><img src="/images/iOSAppConfig.png" alt="Image" /></p> <p>From the upload dialog you must to specify the <strong>Key ID</strong> related to the key and the <strong>Team ID</strong>; this last value is available from <a href="https://developer.apple.com/account/#/membership" target="_blank">Membership Details<img src="/images/ext-link.png" alt="icon" /></a>.</p> <p>Once you successfully upload the key you are ready to broadcast push notifications!</p> <h2 id="broadcasting-push-notifications-from-fcm"> <a href="#broadcasting-push-notifications-from-fcm" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Broadcasting Push Notifications from FCM </h2> <p>Once you have the app configured to send push notifications you can start with a simple test to validate this. Remember that for notifications on iOS devices you must first <a href="/docs/push-notifications/#apple-push-notifications-service-apns-configuration">configure APNs</a>, however it will be possible to receive notifications as modals in any simulator while the app is active. That is, while the app is active you can receive notifications and show them in a dialog or any component you want to design for that. This behavior is defined by the <code class="highlighter-rouge">onMessage</code> method included in <em>/src/screens/splashScreen/index.js</em> for handling new messages, while the app is in <strong>active</strong> mode. If the app is in <strong>background</strong> or <strong>inactive</strong> mode the notification will be handled by the system.</p> <p>To start with a simple test run the React Native project and go to the console to copy the value of the <strong>token key</strong> generated for your device, printed on the React Native console.</p> <p><img src="/images/reactNativeConsole.png" alt="Image" /></p> <p>With this copied value go to the Firebase Console and select the <strong>Cloud Messaging</strong> menu and then click on the <strong>Send your first message</strong> button to compose the notification. From the <strong>Compose notification</strong> screen enter the <strong>Notification title</strong> and the <strong>Notification text</strong>, then click on the <strong>Send test message</strong> button.</p> <p><img src="/images/composeNotification.png" alt="Image" /></p> <p>In the new modal enter the <strong>token key</strong> value, copied previously, and click on <strong>Test</strong> button to send the notification to your device.</p> <p><img src="/images/modalTestNotification.png" alt="Image" /></p> <p>If you have a physical device connected and the app is not in <strong>active</strong> mode, you should see the push notification in the message box.</p> <p><img src="/images/deviceNotification.jpg" alt="Image" /></p> <p>If you are using a simulator or a connected physical device and the app is in <strong>active</strong> mode, you should see the notification from an Alert Dialog.</p> <p><img src="/images/AlertDialog.png" alt="Image" /></p> <hr> <footer role="contentinfo"> <p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2020 Svalbard. Distributed by an <a href="https://github.com/pmarsceill/just-the-docs/tree/master/LICENSE.txt">MIT license.</a></p> </footer> </div> </div> </div> </div> </body> </html>
