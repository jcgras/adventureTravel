<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Firebase Database Rules - Adventure Travel</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Firebase Database Rules | Adventure Travel</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="Firebase Database Rules" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/docs/firebase-database-rules/" /> <meta property="og:url" content="http://localhost:4000/docs/firebase-database-rules/" /> <meta property="og:site_name" content="Adventure Travel" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Firebase Database Rules" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","headline":"Firebase Database Rules","url":"http://localhost:4000/docs/firebase-database-rules/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> Adventure Travel </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="http://localhost:4000/docs/getting-started/" class="nav-list-link">Getting started</a></li><li class="nav-list-item"><a href="http://localhost:4000/docs/backend-config/" class="nav-list-link">Backend configuration</a></li><li class="nav-list-item"><a href="http://localhost:4000/docs/app-config/" class="nav-list-link">App configuration</a></li><li class="nav-list-item"><a href="http://localhost:4000/docs/project-structure/" class="nav-list-link">Project structure</a></li><li class="nav-list-item"><a href="http://localhost:4000/docs/push-notifications/" class="nav-list-link">Push Notifications</a></li><li class="nav-list-item active"><a href="http://localhost:4000/docs/firebase-database-rules/" class="nav-list-link active">Firebase Database Rules</a></li><li class="nav-list-item"><a href="http://localhost:4000/docs/migrating-to-your-brand/" class="nav-list-link">Extra: Migrating to your own brand</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Adventure Travel" aria-label="Search Adventure Travel" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="firebase-database-rules"> <a href="#firebase-database-rules" class="anchor-heading" aria-labelledby="firebase-database-rules"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Firebase Database Rules </h1> <p>Firebase Database Rules (in both scenarios: Realtime Database and Firestore) determine who has read and write access to your database, how your data is structured, and what indexes exist. These rules live on the Firebase servers and are enforced automatically at all times. Every read and write request will only be completed if your rules allow it.</p><hr /> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#realtime-database-rules" id="markdown-toc-realtime-database-rules">Realtime Database Rules</a></li> <li><a href="#cloud-firestore-security-rules" id="markdown-toc-cloud-firestore-security-rules">Cloud Firestore Security Rules</a></li> </ol><hr /> <h2 id="realtime-database-rules"> <a href="#realtime-database-rules" class="anchor-heading" aria-labelledby="realtime-database-rules"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Realtime Database Rules </h2> <p>To manage the security rules of Realtime Databases you must go to the <strong>Realtime Database</strong> menu from <a href="https://console.firebase.google.com" target="_blank">Firebase Console<img src="/images/ext-link.png" alt="icon" /></a> and select the <strong>Rules</strong> tab. If you have created a database in <code class="language-plaintext highlighter-rouge">test mode</code>, you probably have a security rules configuration where you allow anyone to do read and write operations to the database.</p> <p><em>Default security rules in <strong>test mode</strong>:</em></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="dl">"</span><span class="s2">rules</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">.write</span><span class="dl">"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">.read</span><span class="dl">"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>This configuration is appropriate for development and testing environments, but for a production environment it is recommended to add more restrictive rules. For instance we could add rules where for each collection that you try to read or modify is necessary before being authenticated. For that we could use rules like the following:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">rules</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">users</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">$uid</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">.write</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$uid === auth.uid</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">.read</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$uid === auth.uid</span><span class="dl">"</span><span class="p">,</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="dl">"</span><span class="s2">bookmarks</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">$uid</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">.write</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$uid === auth.uid</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">.read</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$uid === auth.uid</span><span class="dl">"</span><span class="p">,</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="dl">"</span><span class="s2">bookings</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">$uid</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">.write</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$uid === auth.uid</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">.read</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$uid === auth.uid</span><span class="dl">"</span><span class="p">,</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>To deepen the security rules of Realtime Database you can review the <a href="https://firebase.google.com/docs/database/security#section-overview" target="_blank">official documentation<img src="/images/ext-link.png" alt="icon" /></a>.</p> <h2 id="cloud-firestore-security-rules"> <a href="#cloud-firestore-security-rules" class="anchor-heading" aria-labelledby="cloud-firestore-security-rules"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cloud Firestore Security Rules </h2> <p>Similar to Realtime Database, <strong>Firestore</strong> handles security rules for database operations. To manage these security rules you must go to the <strong>Cloud Firestore</strong> menu from <a href="https://console.firebase.google.com" target="_blank">Firebase Console<img src="/images/ext-link.png" alt="icon" /></a> and select the <strong>Rules</strong> tab. If you have created a database in <code class="language-plaintext highlighter-rouge">test mode</code>, you probably have a security rules configuration to allows anyone on the internet to view, edit, and delete all data in your Firestore database. This configuration may also have an expiration time of 30 days, after which all client requests to your Firestore database will be denied.</p> <p><em>Default security rules in <strong>test mode</strong>:</em></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">rules_version</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">;</span>
<span class="nx">service</span> <span class="nx">cloud</span><span class="p">.</span><span class="nx">firestore</span> <span class="p">{</span>
  <span class="nx">match</span> <span class="o">/</span><span class="nx">databases</span><span class="o">/</span><span class="p">{</span><span class="nx">database</span><span class="p">}</span><span class="sr">/documents </span><span class="err">{
</span>    <span class="nx">match</span> <span class="o">/</span><span class="p">{</span><span class="nb">document</span><span class="o">=**</span><span class="p">}</span> <span class="p">{</span>
      <span class="nx">allow</span> <span class="nx">read</span><span class="p">,</span> <span class="na">write</span><span class="p">:</span> <span class="k">if</span> <span class="nx">request</span><span class="p">.</span><span class="nx">time</span> <span class="o">&lt;</span> <span class="nx">timestamp</span><span class="p">.</span><span class="nx">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>As you can see, this configuration leaves your app open to attackers. Therefore it is necessary to add rules that guarantee a minimum of security. It would be enough to begin that all the solitudes are of reading only and that the user has to be authenticated to be able to access the documents.</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">rules_version</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">;</span>
<span class="nx">service</span> <span class="nx">cloud</span><span class="p">.</span><span class="nx">firestore</span> <span class="p">{</span>
  <span class="nx">match</span> <span class="o">/</span><span class="nx">databases</span><span class="o">/</span><span class="p">{</span><span class="nx">database</span><span class="p">}</span><span class="sr">/documents </span><span class="err">{
</span>    <span class="nx">match</span> <span class="o">/</span><span class="p">{</span><span class="nb">document</span><span class="o">=**</span><span class="p">}</span> <span class="p">{</span>
      <span class="nx">allow</span> <span class="na">read</span><span class="p">:</span> <span class="k">if</span> <span class="nx">request</span><span class="p">.</span><span class="nx">auth</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>In this session we only intend to introduce the concept of <strong>Firebase Database Rules</strong> so you can add a set of rules that guarantee a minimum of safety. If you want to go deeper and add other more complex configurations, you can access the <a href="https://firebase.google.com/docs/firestore/security/rules-structure" target="_blank">Cloud Firestore Security Rules documentation<img src="/images/ext-link.png" alt="icon" /></a>.</p> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2022 Svalbard. Distributed by an <a href="https://github.com/just-the-docs/just-the-docs/blob/main/LICENSE.txt">MIT license.</a></p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
