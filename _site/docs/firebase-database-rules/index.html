<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Firebase Database Rules - Adventure Travel</title> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs.css"> <script type="text/javascript" src="http://localhost:4000/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Firebase Database Rules | Adventure Travel</title> <meta name="generator" content="Jekyll v3.8.6" /> <meta property="og:title" content="Firebase Database Rules" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/docs/firebase-database-rules/" /> <meta property="og:url" content="http://localhost:4000/docs/firebase-database-rules/" /> <meta property="og:site_name" content="Adventure Travel" /> <script type="application/ld+json"> {"headline":"Firebase Database Rules","@type":"WebPage","url":"http://localhost:4000/docs/firebase-database-rules/","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000" class="site-title lh-tight"> Adventure Travel </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item"><a href="http://localhost:4000/" class="navigation-list-link">Home</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/getting-started/" class="navigation-list-link">Getting started</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/backend-config/" class="navigation-list-link">Backend configuration</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/app-config/" class="navigation-list-link">App configuration</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/project-structure/" class="navigation-list-link">Project structure</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/push-notifications/" class="navigation-list-link">Push Notifications</a></li><li class="navigation-list-item active"><a href="http://localhost:4000/docs/firebase-database-rules/" class="navigation-list-link active">Firebase Database Rules</a></li><li class="navigation-list-item"><a href="http://localhost:4000/docs/migrating-to-your-brand/" class="navigation-list-link">Extra: Migrating to your own brand</a></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Adventure Travel" aria-label="Search Adventure Travel" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> </div> <div class="page"> <div id="main-content" class="page-content" role="main"> <h1 class="no_toc" id="firebase-database-rules"> <a href="#firebase-database-rules" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Firebase Database Rules </h1> <p>Firebase Database Rules (in both scenarios: Realtime Database and Firestore) determine who has read and write access to your database, how your data is structured, and what indexes exist. These rules live on the Firebase servers and are enforced automatically at all times. Every read and write request will only be completed if your rules allow it.</p> <hr /> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#realtime-database-rules" id="markdown-toc-realtime-database-rules">Realtime Database Rules</a></li> <li><a href="#cloud-firestore-security-rules" id="markdown-toc-cloud-firestore-security-rules">Cloud Firestore Security Rules</a></li> </ol> <hr /> <h2 id="realtime-database-rules"> <a href="#realtime-database-rules" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Realtime Database Rules </h2> <p>To manage the security rules of Realtime Databases you must go to the <strong>Realtime Database</strong> menu from <a href="https://console.firebase.google.com" target="_blank">Firebase Console<img src="/images/ext-link.png" alt="icon" /></a> and select the <strong>Rules</strong> tab. If you have created a database in <code class="highlighter-rouge">test mode</code>, you probably have a security rules configuration where you allow anyone to do read and write operations to the database.</p> <p><em>Default security rules in <strong>test mode</strong>:</em></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="dl">"</span><span class="s2">rules</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">.write</span><span class="dl">"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">.read</span><span class="dl">"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>This configuration is appropriate for development and testing environments, but for a production environment it is recommended to add more restrictive rules. For instance we could add rules where for each collection that you try to read or modify is necessary before being authenticated. For that we could use rules like the following:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">rules</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">users</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">$uid</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">.write</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$uid === auth.uid</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">.read</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$uid === auth.uid</span><span class="dl">"</span><span class="p">,</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="dl">"</span><span class="s2">bookmarks</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">$uid</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">.write</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$uid === auth.uid</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">.read</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$uid === auth.uid</span><span class="dl">"</span><span class="p">,</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="dl">"</span><span class="s2">bookings</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">"</span><span class="s2">$uid</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">.write</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$uid === auth.uid</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">.read</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$uid === auth.uid</span><span class="dl">"</span><span class="p">,</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>To deepen the security rules of Realtime Database you can review the <a href="https://firebase.google.com/docs/database/security#section-overview" target="_blank">official documentation<img src="/images/ext-link.png" alt="icon" /></a>.</p> <h2 id="cloud-firestore-security-rules"> <a href="#cloud-firestore-security-rules" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Cloud Firestore Security Rules </h2> <p>Similar to Realtime Database, <strong>Firestore</strong> handles security rules for database operations. To manage these security rules you must go to the <strong>Cloud Firestore</strong> menu from <a href="https://console.firebase.google.com" target="_blank">Firebase Console<img src="/images/ext-link.png" alt="icon" /></a> and select the <strong>Rules</strong> tab. If you have created a database in <code class="highlighter-rouge">test mode</code>, you probably have a security rules configuration to allows anyone on the internet to view, edit, and delete all data in your Firestore database. This configuration may also have an expiration time of 30 days, after which all client requests to your Firestore database will be denied.</p> <p><em>Default security rules in <strong>test mode</strong>:</em></p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">rules_version</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">;</span>
<span class="nx">service</span> <span class="nx">cloud</span><span class="p">.</span><span class="nx">firestore</span> <span class="p">{</span>
  <span class="nx">match</span> <span class="o">/</span><span class="nx">databases</span><span class="o">/</span><span class="p">{</span><span class="nx">database</span><span class="p">}</span><span class="sr">/documents </span><span class="err">{
</span>    <span class="nx">match</span> <span class="o">/</span><span class="p">{</span><span class="nb">document</span><span class="o">=**</span><span class="p">}</span> <span class="p">{</span>
      <span class="nx">allow</span> <span class="nx">read</span><span class="p">,</span> <span class="nx">write</span><span class="p">:</span> <span class="k">if</span> <span class="nx">request</span><span class="p">.</span><span class="nx">time</span> <span class="o">&lt;</span> <span class="nx">timestamp</span><span class="p">.</span><span class="nx">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>As you can see, this configuration leaves your app open to attackers. Therefore it is necessary to add rules that guarantee a minimum of security. It would be enough to begin that all the solitudes are of reading only and that the user has to be authenticated to be able to access the documents.</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">rules_version</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">;</span>
<span class="nx">service</span> <span class="nx">cloud</span><span class="p">.</span><span class="nx">firestore</span> <span class="p">{</span>
  <span class="nx">match</span> <span class="o">/</span><span class="nx">databases</span><span class="o">/</span><span class="p">{</span><span class="nx">database</span><span class="p">}</span><span class="sr">/documents </span><span class="err">{
</span>    <span class="nx">match</span> <span class="o">/</span><span class="p">{</span><span class="nb">document</span><span class="o">=**</span><span class="p">}</span> <span class="p">{</span>
      <span class="nx">allow</span> <span class="nx">read</span><span class="p">:</span> <span class="k">if</span> <span class="nx">request</span><span class="p">.</span><span class="nx">auth</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>In this session we only intend to introduce the concept of <strong>Firebase Database Rules</strong> so you can add a set of rules that guarantee a minimum of safety. If you want to go deeper and add other more complex configurations, you can access the <a href="https://firebase.google.com/docs/firestore/security/rules-structure" target="_blank">Cloud Firestore Security Rules documentation<img src="/images/ext-link.png" alt="icon" /></a>.</p> <hr> <footer role="contentinfo"> <p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2020 Svalbard. Distributed by an <a href="https://github.com/pmarsceill/just-the-docs/tree/master/LICENSE.txt">MIT license.</a></p> </footer> </div> </div> </div> </div> </body> </html>
